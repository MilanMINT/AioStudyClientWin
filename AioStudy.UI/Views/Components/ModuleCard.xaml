<UserControl x:Class="AioStudy.UI.Views.Components.ModuleCard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:MaIc="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
             xmlns:local="clr-namespace:AioStudy.UI.Views.Components"
             mc:Ignorable="d" 
             d:DesignHeight="200" d:DesignWidth="380">
    
    
    <UserControl.Resources>
        <!-- Status Badge Style -->
        <Style x:Key="StatusBadge" TargetType="Border">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style>
    </UserControl.Resources>

    <Border Width="380" 
        Height="200"
        Background="#2A2D35"
        CornerRadius="12"
        Margin="15"
        Padding="20"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        BorderThickness="2">

        <!-- Dynamischer BorderBrush basierend auf Module.Color -->
        <Border.BorderBrush>
            <LinearGradientBrush>
                <GradientStop Color="#608BC1" Offset="0.0"/>
                <GradientStop Color="#133E87" Offset="1.0"/>
                <!-- Bindet an Module.Color, falls null wird Standard-Hellblau verwendet -->
                <GradientStop Color="{Binding ModuleColor, TargetNullValue=#a5bacc, FallbackValue=#a5bacc}" Offset="0.5"/>
            </LinearGradientBrush>
        </Border.BorderBrush>

        <!-- Shadow Effect -->
        <Border.Effect>
            <DropShadowEffect Color="black"
                          Direction="270"
                          ShadowDepth="4"
                          BlurRadius="7"
                          Opacity="0.6"/>
        </Border.Effect>

        <!-- Hover Trigger -->
        <Border.Style>
            <Style TargetType="Border">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background">
                            <Setter.Value>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#353842" Offset="0.0"/>
                                    <GradientStop Color="#2A2D35" Offset="1.0"/>
                                </LinearGradientBrush>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="BorderBrush">
                            <Setter.Value>
                                <LinearGradientBrush>
                                    <GradientStop Color="#7BA3D3" Offset="0.0"/>
                                    <GradientStop Color="#1E4A99" Offset="1.0"/>
                                    <GradientStop Color="#B5C7DA" Offset="0.7"/>
                                </LinearGradientBrush>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="Effect">
                            <Setter.Value>
                                <DropShadowEffect Color="black"
                                              Direction="270"
                                              ShadowDepth="6"
                                              BlurRadius="10"
                                              Opacity="0.7"/>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Border.Style>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header mit Titel und Actions -->
            <Grid Grid.Row="0" Margin="0,0,0,5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="{Binding ModuleName}" 
                           FontSize="20" 
                           FontWeight="Bold" 
                           Foreground="White"
                           TextTrimming="CharacterEllipsis"
                           ToolTip="{Binding ModuleName}"/>
                </StackPanel>

                <!-- Delete Button -->
                <Button Grid.Column="1"
                    Command="{Binding DeleteCommand}"
                    Style="{StaticResource NoHoverButtonStyle}"
                    Width="22"
                    Height="22"
                    ToolTip="Delete Module">
                    <Border Background="#FF4757"
                        CornerRadius="16"
                        Width="22"
                        Height="22">
                        <MaIc:MaterialIcon Kind="DeleteOutline"
                                       Foreground="White"
                                       Width="16"
                                       Height="16"/>
                        <Border.Style>
                            <Style TargetType="Border">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#FF3742"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                    </Border>
                </Button>
            </Grid>

            <!-- Module Stats -->
            <Grid Grid.Row="1" Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Credits -->
                <StackPanel Grid.Column="0" HorizontalAlignment="Left">
                    <TextBlock Text="Credits" 
                           FontSize="11" 
                           Foreground="#8A8D95" 
                           Margin="0,0,0,2"/>
                    <TextBlock FontSize="16" 
                           FontWeight="Bold" 
                           Foreground="#4A90E2"
                           Text="{Binding CreditsDisplay}"/>
                </StackPanel>

                <!-- Grade -->
                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="Grade" 
                           FontSize="11" 
                           Foreground="#8A8D95" 
                           Margin="0,0,0,2"/>
                    <TextBlock FontSize="16" 
                           FontWeight="Bold"
                           Text="{Binding GradeDisplay}"
                           Foreground="{Binding GradeColor}"/>
                </StackPanel>

                <!-- Study Time -->
                <StackPanel Grid.Column="2" HorizontalAlignment="Right">
                    <TextBlock Text="Study Time" 
                           FontSize="11" 
                           Foreground="#8A8D95" 
                           Margin="0,0,0,2"/>
                    <TextBlock FontSize="16" 
                           FontWeight="Bold" 
                           Foreground="#FF8A00"
                           Text="{Binding StudyTimeDisplay}"/>
                </StackPanel>
            </Grid>

            <!-- Exam Date Info -->
            <StackPanel Grid.Row="2" 
                    VerticalAlignment="Center"
                    Margin="0,10">
                <TextBlock Text="Exam Date" 
                       FontSize="11" 
                       Foreground="#8A8D95" 
                       Margin="0,0,0,4"/>

                <Border Background="{Binding ExamDateBadgeColor}"
                    Style="{StaticResource StatusBadge}">
                    <StackPanel Orientation="Horizontal">
                        <MaIc:MaterialIcon Kind="Calendar"
                                       Width="14"
                                       Height="14"
                                       Foreground="White"
                                       Margin="0,0,6,0"/>
                        <TextBlock Foreground="White" 
                               FontSize="12"
                               FontWeight="Medium"
                               Text="{Binding ExamDateDisplay}"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Footer mit Created Date -->
            <Grid Grid.Row="3" 
              Margin="0,15,0,0"
              Opacity="0.7">
                <TextBlock Text="{Binding CreatedDisplay}" 
                       Foreground="#6B7280" 
                       FontSize="10"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Bottom"/>
            </Grid>
        </Grid>
    </Border>


</UserControl>

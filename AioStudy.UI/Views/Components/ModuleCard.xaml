<UserControl
    x:Class="AioStudy.UI.Views.Components.ModuleCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:MaIc="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:AioStudy.UI.Views.Components"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Width="510"
    Height="250"
    d:DesignHeight="250"
    d:DesignWidth="450"
    Background="#222324"
    mc:Ignorable="d">


    <Border
        x:Name="CardBorder"
        BorderThickness="2"
        CornerRadius="8"
        RenderTransformOrigin="0.5,0.5">

        <Border.Effect>
            <DropShadowEffect
                x:Name="CardShadow"
                BlurRadius="4"
                Direction="270"
                Opacity="0.2"
                ShadowDepth="2"
                Color="Black" />
        </Border.Effect>

        <Border.RenderTransform>
            <ScaleTransform x:Name="CardScale" ScaleX="1" ScaleY="1" />
        </Border.RenderTransform>


        <Border.BorderBrush>
            <LinearGradientBrush>
                <GradientStop Offset="0.0" Color="{Binding Color, TargetNullValue=#608BC1, FallbackValue=#608BC1}" />
                <GradientStop Offset="1.0" Color="#133E87" />
                <GradientStop Offset="0.5" Color="#a5bacc" />
            </LinearGradientBrush>
        </Border.BorderBrush>

        <Border.Background>
            <LinearGradientBrush>
                <GradientStop Offset="0.0" Color="#1F2024" />
                <GradientStop Offset="1.0" Color="#1A1B1E" />
            </LinearGradientBrush>
        </Border.Background>

        <Border.Triggers>
            <EventTrigger RoutedEvent="MouseEnter">
                <BeginStoryboard>
                    <Storyboard>
                        <!--  DropShadow Animation  -->
                        <DoubleAnimation
                            Storyboard.TargetName="CardShadow"
                            Storyboard.TargetProperty="ShadowDepth"
                            To="5"
                            Duration="0:0:0.3">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>

                        <DoubleAnimation
                            Storyboard.TargetName="CardShadow"
                            Storyboard.TargetProperty="BlurRadius"
                            To="16"
                            Duration="0:0:0.3">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>

                        <DoubleAnimation
                            Storyboard.TargetName="CardShadow"
                            Storyboard.TargetProperty="Opacity"
                            To="0.5"
                            Duration="0:0:0.3">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>

                        <!--  Delete Button einblenden  -->
                        <DoubleAnimation
                            Storyboard.TargetName="DeleteButton"
                            Storyboard.TargetProperty="Opacity"
                            To="1.0"
                            Duration="0:0:0.1" />

                        <!--  Edit Button einblenden  -->
                        <DoubleAnimation
                            Storyboard.TargetName="EditButton"
                            Storyboard.TargetProperty="Opacity"
                            To="1.0"
                            Duration="0:0:0.1" />

                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>

            <!--  MouseLeave  -->
            <EventTrigger RoutedEvent="MouseLeave">
                <BeginStoryboard>
                    <Storyboard>

                        <DoubleAnimation
                            Storyboard.TargetName="CardShadow"
                            Storyboard.TargetProperty="ShadowDepth"
                            To="2"
                            Duration="0:0:0.2">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>

                        <DoubleAnimation
                            Storyboard.TargetName="CardShadow"
                            Storyboard.TargetProperty="BlurRadius"
                            To="4"
                            Duration="0:0:0.2">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>

                        <DoubleAnimation
                            Storyboard.TargetName="CardShadow"
                            Storyboard.TargetProperty="Opacity"
                            To="0.2"
                            Duration="0:0:0.2">
                            <DoubleAnimation.EasingFunction>
                                <QuadraticEase EasingMode="EaseOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>

                        <DoubleAnimation
                            Storyboard.TargetName="DeleteButton"
                            Storyboard.TargetProperty="Opacity"
                            To="0"
                            Duration="0:0:0.2" />

                        <DoubleAnimation
                            Storyboard.TargetName="EditButton"
                            Storyboard.TargetProperty="Opacity"
                            To="0"
                            Duration="0:0:0.1" />

                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Border.Triggers>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="60" />
                <RowDefinition Height="1" />
                <RowDefinition Height="*" />
                <RowDefinition Height="1" />
                <RowDefinition Height="30" />
                <RowDefinition Height="23" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="50" />
            </Grid.ColumnDefinitions>

            <DockPanel Grid.ColumnSpan="2" LastChildFill="False">
                <Border
                    Height="35"
                    Margin="0,0,10,0"
                    Padding="12,6"
                    Background="#282A2E"
                    BorderBrush="#51565C"
                    BorderThickness="1"
                    CornerRadius="10"
                    DockPanel.Dock="Right">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock
                            FontSize="14"
                            FontWeight="SemiBold"
                            Foreground="#E0E0E0"
                            Text="{Binding Semester.Name, FallbackValue='Not set!'}" />
                    </StackPanel>
                </Border>
                <TextBlock
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="15,0,22,0"
                    VerticalAlignment="Center"
                    FontSize="23"
                    FontWeight="Bold"
                    Foreground="#E0E0E0"
                    Text="{Binding Name, FallbackValue='Not sedqdq qdqwdqwdqwd qwdqwdqwdqwdt!'}"
                    TextTrimming="CharacterEllipsis"
                    ToolTip="{Binding Name}" />
            </DockPanel>


            <!--  Separator  -->
            <Border
                Grid.Row="1"
                Grid.ColumnSpan="2"
                Height="1"
                Margin="15,0,15,0"
                Background="#3A3D45" />

            <!--  Separator  -->
            <Border
                Grid.Row="3"
                Grid.ColumnSpan="2"
                Height="1"
                Margin="15,0,15,0"
                Background="#3A3D45" />


            <Grid
                Grid.Row="2"
                Grid.ColumnSpan="2"
                Margin="0,10,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!--  Zeile 1  -->
                <StackPanel
                    Grid.Row="0"
                    Margin="0,10,0,10"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">

                    <!--  Examdate  -->
                    <Border
                        Margin="0,0,10,0"
                        Padding="12,6"
                        Background="#2C3448"
                        BorderBrush="#3C4F7A"
                        BorderThickness="1"
                        CornerRadius="10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#AFC4FF"
                                Text="Examdate: " />
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#E5E7EB"
                                Text="{Binding ExamDateString, FallbackValue='Open'}" />
                        </StackPanel>
                    </Border>

                    <!--  Studytime  -->
                    <Border
                        Padding="12,6"
                        Background="#322C4A"
                        BorderBrush="#5D4E91"
                        BorderThickness="1"
                        CornerRadius="10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#D3BFFF"
                                Text="Studytime: " />
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#F4EFFF"
                                Text="{Binding Module.LearnedMinutes, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource MinutesToStringConverter}, TargetNullValue='N/A'}" />
                        </StackPanel>
                    </Border>

                </StackPanel>

                <!--  Zeile 2  -->
                <StackPanel
                    Grid.Row="1"
                    Margin="0,10,0,10"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Orientation="Horizontal">

                    <!--  Credits  -->
                    <Border
                        Margin="0,0,10,0"
                        Padding="12,6"
                        Background="#2F3338"
                        BorderBrush="#51565C"
                        BorderThickness="1"
                        CornerRadius="10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#B0B3B8"
                                Text="Credits: " />
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#E0E0E0"
                                Text="{Binding ModuleCredits, FallbackValue=6}" />
                        </StackPanel>
                    </Border>

                    <!--  Status  -->
                    <Border
                        Margin="0,0,10,0"
                        Padding="12,6"
                        Background="#3C3522"
                        BorderBrush="#B08F2E"
                        BorderThickness="1"
                        CornerRadius="10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#F6E05E"
                                Text="Status: " />
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#FFF8C1"
                                Text="{Binding ExamStatus, FallbackValue='Pending', TargetNullValue='Open'}" />
                        </StackPanel>
                    </Border>

                    <!--  Grade  -->
                    <Border
                        Padding="12,6"
                        Background="#382B4A"
                        BorderBrush="#7E57C2"
                        BorderThickness="1"
                        CornerRadius="10">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#D1B3FF"
                                Text="Grade: " />
                            <TextBlock
                                FontSize="14"
                                FontWeight="SemiBold"
                                Foreground="#F3EFFF"
                                Text="{Binding Grade, FallbackValue=2.3, StringFormat=F1, TargetNullValue='N/A'}" />
                        </StackPanel>
                    </Border>

                </StackPanel>
            </Grid>




            <StackPanel
                Grid.Row="5"
                Margin="9,0,0,0"
                VerticalAlignment="Center"
                Orientation="Horizontal">
                <MaIc:MaterialIcon
                    Width="12"
                    Height="12"
                    Margin="0,0,2,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Foreground="#606069"
                    Kind="CreateOutline" />
                <TextBlock
                    Margin="0,0,0,2"
                    FontSize="11"
                    Foreground="#606069"
                    Text="{Binding CreatedString, FallbackValue=Test, StringFormat='dd.MM.yyyy'}"
                    TextAlignment="Center" />
            </StackPanel>

            <DockPanel
                Grid.Row="4"
                Grid.RowSpan="2"
                Grid.ColumnSpan="2"
                LastChildFill="False">
                <Button
                    x:Name="DeleteButton"
                    Grid.Row="5"
                    Grid.RowSpan="3"
                    Grid.Column="1"
                    Width="30"
                    Height="30"
                    Margin="10,0,15,0"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Panel.ZIndex="9999"
                    Command="{Binding DeleteCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                    CommandParameter="{Binding Module, RelativeSource={RelativeSource AncestorType=UserControl}}"
                    DockPanel.Dock="Right"
                    Opacity="0"
                    SnapsToDevicePixels="True"
                    Style="{StaticResource RedGradientButtonThinBorder}"
                    UseLayoutRounding="True">
                    <MaIc:MaterialIcon
                        Width="20"
                        Height="20"
                        Margin="0,0,0,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="#8F7979"
                        Kind="DeleteOutline"
                        SnapsToDevicePixels="True"
                        UseLayoutRounding="True" />
                </Button>

                <Button
                    x:Name="EditButton"
                    Grid.Row="3"
                    Grid.RowSpan="3"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    Width="30"
                    Height="30"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Panel.ZIndex="9999"
                    Command="{Binding OpenModuleOverviewCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                    CommandParameter="{Binding Module, RelativeSource={RelativeSource AncestorType=UserControl}}"
                    DockPanel.Dock="Right"
                    Opacity="0"
                    SnapsToDevicePixels="True"
                    Style="{StaticResource GrayGradientButton}"
                    UseLayoutRounding="True">
                    <MaIc:MaterialIcon
                        Width="20"
                        Height="20"
                        Margin="0,0,0,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Foreground="#787777"
                        Kind="OpenInNew"
                        SnapsToDevicePixels="True"
                        UseLayoutRounding="True" />
                </Button>
            </DockPanel>
        </Grid>
    </Border>
</UserControl>

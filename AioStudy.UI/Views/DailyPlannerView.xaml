<UserControl
    x:Class="AioStudy.UI.Views.DailyPlannerView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:MaIc="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:AioStudy.UI.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="clr-namespace:AioStudy.UI.ViewModels"
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
    d:DataContext="{d:DesignInstance Type=viewmodels:DailyPlannerViewModel}"
    d:DesignHeight="750"
    d:DesignWidth="1200"
    Background="#212226"
    mc:Ignorable="d">

    <Grid x:Name="LayoutRoot">
        <Grid.RowDefinitions>
            <RowDefinition Height="80" />
            <RowDefinition Height="1" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Header  -->
        <Grid Grid.Row="0" Margin="30,0,30,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!--  Titel Sektion  -->
            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                <TextBlock
                    Margin="0,0,0,4"
                    FontSize="32"
                    FontWeight="Bold"
                    Foreground="White"
                    Text="Daily planner" />
                <StackPanel Orientation="Horizontal">
                    <MaIc:MaterialIcon
                        Width="16"
                        Height="16"
                        Margin="0,0,5,0"
                        VerticalAlignment="Bottom"
                        Foreground="#B0B3BA"
                        Kind="CalendarWeek" />
                    <TextBlock
                        FontSize="14"
                        Foreground="#B0B3BA"
                        Text="Manage your tasks for the week!" />
                </StackPanel>
            </StackPanel>

            <!--  Semester Filter & Actions  -->
            <StackPanel
                Grid.Column="1"
                VerticalAlignment="Center"
                Orientation="Horizontal">

                <Button Command="{Binding PrevDayCommand}" Style="{StaticResource NoHoverButtonStyle}">
                    <MaIc:MaterialIcon
                        Width="27"
                        Height="27"
                        Margin="0,1,0,0"
                        Foreground="White"
                        Kind="ChevronLeft " />
                </Button>

                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                    <ToggleButton
                        x:Name="CalendarToggle"
                        Width="100"
                        Height="37"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        Style="{StaticResource NoHoverToggleButtonStyle}"
                        ToolTip="Open calendar">
                        <TextBlock
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="18"
                            Foreground="White"
                            Text="{Binding SelectedDate, StringFormat='{}{0:dd.MM.yyyy}', TargetNullValue='-', FallbackValue='20.03.2005'}" />
                    </ToggleButton>

                    <Popup
                        AllowsTransparency="True"
                        IsOpen="{Binding IsChecked, ElementName=CalendarToggle}"
                        Placement="Bottom"
                        PlacementTarget="{Binding ElementName=CalendarToggle}"
                        StaysOpen="False">
                        <Border
                            Padding="6"
                            Background="#2B2E31"
                            BorderBrush="#3A3D45"
                            BorderThickness="1"
                            CornerRadius="6"
                            SnapsToDevicePixels="True">
                            <Calendar
                                x:Name="InlineCalendar"
                                Background="white"
                                BorderThickness="0"
                                Foreground="White"
                                SelectedDate="{Binding SelectedDate, Mode=TwoWay, Converter={StaticResource DateOnlyConverter}}"
                                SelectedDatesChanged="Calendar_SelectedDatesChanged"
                                SelectionMode="SingleDate">
                                <Calendar.Resources>
                                    <Style TargetType="CalendarDayButton">
                                        <Setter Property="Foreground" Value="White" />
                                    </Style>
                                </Calendar.Resources>
                            </Calendar>
                        </Border>
                    </Popup>
                </StackPanel>

                <Button Command="{Binding NextDayCommand}" Style="{StaticResource NoHoverButtonStyle}">
                    <MaIc:MaterialIcon
                        Width="27"
                        Height="27"
                        Margin="0,1,20,0"
                        Foreground="White"
                        Kind="ChevronRight" />
                </Button>

                <!--  Refresh Button  -->
                <Button
                    Width="45"
                    Command="{Binding RefreshCommand}"
                    Style="{StaticResource GradientButton}"
                    ToolTip="Refresh Grades">
                    <MaIc:MaterialIcon
                        Width="22"
                        Height="22"
                        Kind="Refresh" />
                </Button>
            </StackPanel>

        </Grid>


        <!--  Separator  -->
        <Border
            Grid.Row="1"
            Height="1"
            Margin="30,0"
            Background="#3A3D45" />

        <!--  Content  -->
        <Grid Grid.Row="2" Margin="30,20,30,30">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <!--  Tasks List  -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding Tasks}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border
                                Margin="0,0,0,15"
                                Padding="15"
                                Background="#2B2E31"
                                CornerRadius="8">
                                <StackPanel>
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="Bold"
                                        Foreground="White"
                                        Text="{Binding Title}" />
                                    <TextBlock
                                        Margin="0,5,0,0"
                                        FontSize="14"
                                        Foreground="#B0B3BA"
                                        Text="{Binding Description}" />
                                    <TextBlock
                                        Margin="0,5,0,0"
                                        FontSize="12"
                                        Foreground="#888A8E"
                                        Text="{Binding TimeRange}" />
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
            <!--  Actions Panel  -->
            <StackPanel
                x:Name="ActionsPanel"
                Grid.Column="1"
                Width="200"
                Margin="20,0,0,0"
                VerticalAlignment="Top">
                <Button
                    Height="40"
                    Margin="0,0,0,10"
                    Command="{Binding AddTaskCommand}"
                    Style="{StaticResource GradientButton}">
                    <TextBlock
                        FontSize="16"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="+ Add Task" />
                </Button>
                <Button
                    Height="40"
                    Command="{Binding ClearTasksCommand}"
                    Style="{StaticResource GradientButton}">
                    <TextBlock
                        FontSize="16"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="Clear All Tasks" />
                </Button>
            </StackPanel>
        </Grid>




        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="AdaptiveStates">
                <VisualState x:Name="Wide">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ActionsPanel" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                <DiscreteObjectKeyFrame.Value>
                                    <Visibility>Visible</Visibility>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Narrow">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ActionsPanel" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                <DiscreteObjectKeyFrame.Value>
                                    <Visibility>Collapsed</Visibility>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>


</UserControl>
